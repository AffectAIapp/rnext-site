<script>
  (function () {
    const media = document.getElementById("heroMedia");
    if (!media) return;

    const prefersReduced = window.matchMedia && window.matchMedia("(prefers-reduced-motion: reduce)").matches;

    function clamp(n, min, max){ return Math.max(min, Math.min(max, n)); }

    function update(){
      if (prefersReduced) return;

      const y = window.scrollY || 0;
      const headerH = parseFloat(getComputedStyle(document.documentElement).getPropertyValue("--header-h")) || 0;
      const heroH = Math.max(1, window.innerHeight - headerH);

      /* progresso do scroll dentro do hero */
      const t = clamp(y / heroH, 0, 1);

      /* PARALLAX */
      const translate = y * 0.09;         /* rolagem dentro do banner */
      const scale = 1.05 + (t * 0.012);   /* zoom bem suave */

      media.style.transform = "translate3d(0," + (-translate) + "px,0) scale(" + scale.toFixed(4) + ")";

      /* CROP + REVELAÇÃO (janela abrindo) */
      const topStart = 12;    /* % de crop no topo no início */
      const botStart = 18;    /* % de crop embaixo no início */

      const top = (1 - t) * topStart;
      const bot = (1 - t) * botStart;

      media.style.clipPath = "inset(" + top.toFixed(2) + "% 0 " + bot.toFixed(2) + "% 0)";
    }

    update();
    window.addEventListener("scroll", update, { passive: true });
    window.addEventListener("resize", update);
  })();
</script>
